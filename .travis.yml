language: php
php:
- 7.0
git:
  depth: 30
before_script:
  - composer require squizlabs/php_codesniffer:2.*
  - mkdir -p ~/build
  - git clone --branch hubzero-cms-2.1 --depth=1 https://github.com/hubzero/standards ~/build/standards
  - git config diff.renameLimit 0
  - changed_files=`git diff --name-only $TRAVIS_COMMIT_RANGE`
  - for f in $changed_files; do if [[ -f "$f" ]]; then files_exist="$files_exist $f"; else files_removed="$files_removed $f"; fi done
  - echo "The following will be tested:"
  - echo $files_exist
  - echo "The following were removed:"
  - echo $files_removed
script:
- core/bin/php_tests.sh $files_exist
