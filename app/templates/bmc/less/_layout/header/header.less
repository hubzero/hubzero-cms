header.page {
	position: fixed;
	z-index: 900;
	//width: 100%;
	width: calc(100% ~ "-" 7px);
	top: 0;
	// hides search, need to find a better solution to mask the search panel on overscrolling
	//overflow: hidden;
	.transition();

	nav {

		a {
			color: @colorTextDark;
		}

		ul,
		li {
			list-style: none;
			padding: 0;
			margin: 0;
		}

		li {
			display: inline-block;
		}

		&.nav-primary,
		&.nav-secondary {
			width: auto;
			li {

				a {
					line-height: @logoHeight + @headerTopBottomPadding * 2;
					display: inline-block;
					margin-right: 1rem;
					position: relative;
					.transition(line-height ease-in .3s);
					font-family: @fontGeometric;

					&:hover {
						color: @colorLink;
					}
				}

				a.hidden {
					display: none;
				}

				span:hover {
					color: @colorLink !important;
				}

				&:last-child {

					a {
						margin-right: 0;
					}
				}

				ul {
					display: none;
				}

				&.active {

					a {

						&:after {
							.ab();
							bottom: 1.3rem;
							left: 0;
							width: 100%;
							height: 2px;
							background: @colorTheme;
							transition: bottom ease-in .3s, height ease-in .3s;
						}
					}
				}
			}

			li.removeMargin {
				a {
					margin-right: 0;
				}
			}
		}
	}

	// Adjust for smaller text for secondary menu
	nav.nav-secondary {
		ul {
			 display: inline-block;
			 vertical-align: middle;
		}

		li.active a:after {
			bottom: 0.5rem;
		}
	}

	// Adjust help indicator (triangle)
	nav.nav-secondary li.helpme.active a:after {
    display: none;
	}

	.brand {
		float: left;
		padding-right: 0.2rem;
		margin-right: 2rem;
		padding-top: @headerTopBottomPadding;
		padding-bottom: @headerTopBottomPadding;
		.transition();

		.logo {
			width: @logoWidth;
			height: @logoHeight;
			position: relative;
			.transition();

			svg {
				width: 100%;
				height: 100%;
				position: absolute;
				top: 0;
				left: 0;
			}
		}
	}

	nav.nav-primary {
		float: left;
	}

	li#help {
		padding: 0 8px 0 4px;
	}

	button.mobile-menu,
	button.dashboard,
	button.search {
		display: none;
	}

	.aux {
		float: right;
		text-align: right;
		padding-top: @headerTopBottomPadding;
		padding-bottom: @headerTopBottomPadding;
		transition: padding ease-in .3s;

		nav {
			display: inline-block;

			&.nav-secondary {
				margin-right: 2rem;
				position: relative;

				&:after {
					.ab();
					left: 100%;
					top: 50%;
					height: 1px;
					width: 1.5rem;
					background: #c1c1c1;
				}

				a {
					line-height: @logoHeight;
					display: inline-block;
					font-size: 0.75rem;
					margin-right: 0.5rem;
					.transition(line-height ease-in .3s);
				}
			}

			&.buttons {

				.search {
					//margin-right: 1rem;
					padding-left: 1.3rem;
					position: relative;

					.icon {
						display: inline-block;
						width: 0.8rem;
						height: 1.4em;
						position: absolute;
						top: 50%;
						left: 0;
						transform: translate(0, -50%);
					}
				}

				.dashboard {
					padding-left: 1rem;
					position: relative;

					&.loggedin {
						padding-left: 0;
					}

					.icon {
						display: inline-block;
						width: 1rem;
						height: 1.4em;
						position: absolute;
						top: 50%;
						left: 0;
						transform: translate(0, -50%);
					}

					img {
						width: @logoHeight;
						border-radius: 50%;
						border: 1px solid #efefef;
						//box-shadow: 0 1px 3px rgba(0,0,0,0.3);
						.transition();
					}

					span {
						padding-left: 0.5rem;
						font-size: 0.75rem;
					}
				}

				& > *	 {
					display: inline-block;
				}
			}
		}
	}

	.main,
	& > .sub,
	.search-panel {
		.padContain();
	}

	.wrap-main {
		position: relative;
	}

	.main {
		box-shadow: 0px 1px 10px rgba(0, 0, 0, 0.05);
		position: relative;
		z-index: 3;
		background: #fff;
		height: @logoHeight + @headerTopBottomPadding * 2;
		overflow: hidden;
		.transition(height ease-in .3s);

		&:before {
			.ab();
			height: 100%;
			width: 100%;
			bottom: 100%;
			left: 0;
			background: #fff;
		}
	}

	.search-panel {
		padding-top: 1rem;
		padding-bottom: 1rem;
		background: #303544;
		position: absolute;
		z-index: 2;
		width: 100%;
		.transition();
		transform: translate(0, -101%);

		&.show {
			transform: translate(0, 0);
		}

		.text-field {
			position: relative;
		}

		form {
			border: 1px solid #fff;
			position: relative;
			border: none;
			margin-right: 3rem;

			.searchword {
				width: 100%;
				border: none;
				line-height: 24px;
				padding: 3px 1rem;
			}

			button,
			.searchsubmit {
				position: absolute;
				right: 0;
				top: 0;
				bottom: 0;
				background: none;
				border: none;
				cursor: pointer;
				z-index: 1;
				opacity: 0;
				width: 3rem;
			}

			.icon {
				position: absolute;
				height: 1.2rem;
				width: 1rem;
				right: 1rem;
				top: 50%;
				z-index: 0;
				transform: translate(0, -50%);
			}
		}

		.close {
			position: absolute;
			right: 0;
			top: 50%;
			transform: translate(0, -50%);
			color: #fff;
			.closeButton(30px);
		}
	}

	& > .sub {
		background: #FBFBFB;
		border-bottom: 1px solid #EAEAEA;
		z-index: 1;
		position: relative;
		.transition();
		height: 3.6rem;
		//min-height: 3.6rem;
		font-family: @fontGeometricLight;
		position: absolute;
		width: 100%;
		transform: translate(0, 100%);
		bottom: 0;

		// spacer (hacky, but hell, it works!!!!)
		&:after {
			.ab();
			height: 5px;
			background: #FBFBFB;
			width: 100%;
			bottom: 100%;
			left: 0;
			//background: red;
		}

		&.out {
			transform: translate(0, 0);
		}

		nav {
			display: inline-block;
			.transition();
			position: relative;
			margin-left: @logoWidth + 2.2rem;
			z-index: 8;

			li {

				a {
					margin-right: 1rem;
					font-size: 0.8rem;
					line-height: 3.6rem;
					display: inline-block;
				}

				&.active {

					a {
						font-family: @fontGeometricSemiBold;
					}
				}
			}

			li:last-child {

				a {
					margin-right: 0;
				}
			}

			&.hide {
				opacity: 0;
				visibility: hidden;
			}

			&.empty {
				font-size: 0.8rem;
				line-height: 3.6rem;
			}
		}
	}

	&.skinny,
	&.mobile,
	&.slim {

		.main {
			height: @skinnyLogoHeight + @skinnyHeaderTopBottomPadding * 2;
		}

		nav {

			&.nav-primary {

				li {

					a {
						line-height: @skinnyLogoHeight + @skinnyHeaderTopBottomPadding * 2;
					}

					&.active {

						a {

							&:after {
								bottom: 0.9rem;
								height: 1px;
							}
						}
					}
				}
			}

			&.nav-secondary li.active a:after{
				bottom: 0.3rem;
				height: 1px;
			}
		}

		.brand {
			padding-top: @skinnyHeaderTopBottomPadding;
			padding-bottom: @skinnyHeaderTopBottomPadding;

			.logo {
				width: @skinnyLogoWidth;
				height: @skinnyLogoHeight;
			}
		}

		.aux {
			padding-top: @skinnyHeaderTopBottomPadding;
			padding-bottom: @skinnyHeaderTopBottomPadding;

			nav {

				&.nav-secondary {

					a {
						line-height: @skinnyLogoHeight;
					}
				}

				&.buttons {

					.dashboard {

						img {
							width: @skinnyLogoHeight;
						}
					}
				}
			}
		}

		& > .sub {

			nav {
				margin-left: @skinnyLogoWidth + 2.2rem;
			}
		}
	}
}

// Mobile styles
body.mobile,
body.slim {

	header.page {

		.main {

			.main-inner {
				position: relative;
			}

			.nav-primary,
			.aux {
				visibility: hidden;
			}

			button.mobile-menu,
			button.dashboard,
			button.search {
				display: inline-block;
				border: 0;
				background: none;
				padding: 0;
				margin: 0;
				line-height: @logoHeight + @headerTopBottomPadding * 2;
				font-size: 0.8rem;
				position: relative;
				padding-left: 1.5rem;
				.transition();
				outline: none;
				cursor: pointer;
				position: absolute;
				top: 0;

				& > div {
					display: inline-block;
					line-height: 0;
					width: 1.2rem;
					position: absolute;
					top: 50%;
					left: 0;
					transform: translate(0, -50%);
				}

				span {
					//display: none;
				}
			}

			button.mobile-menu {
				left: @logoWidth + 2rem + 1rem; // logoW + container padding + gap
			}

			button.dashboard {
				right: 2rem;
			}

			button.search {
				right: 4rem;
			}
		}

		.sub,
		.search-panel {
			display: none;
		}

		&.skinny,
		&.mobile,
		&.slim {

			button.mobile-menu,
			button.dashboard,
			button.search {
				line-height: @skinnyLogoHeight + @skinnyHeaderTopBottomPadding * 2;
			}

			button.mobile-menu {
				left: @skinnyLogoWidth + 2rem + 0.75rem; // logoW + container padding + smaller gap
			}
		}

	}
}
